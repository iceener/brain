<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Instalacja  Zainstalowanie CLI: npm i -g @nestjs/cli Utworzenie nowego projektu nest new [nazwa]  Struktura projektu Podstawową struktury kodu w NestJS są klasy (eng."><title>Podstawy - brain.overment.com</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://overment.com/icon.png><meta property="og:title" content="Wszystko co wiem"><meta property="og:site_name" content="brain.overment.com"><meta property="og:url" content="https://brain.overment.com"><meta property="og:description" content="W tym miejscu dzielę się z Tobą wszystkim co wiem. Stworzyłem je przede wszystkim dla siebie, aby móc łatwo wracać do wszystkich zamieszczonych tu materiałów. Jednocześnie pomyślałem że to wszystko może okazać się równie wartościowe dla Ciebie."><meta property="og:type" content="website"><meta property="og:image" content="https://space.overment.com/brain-xAnbd/brain.png"><link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,900;1,900&family=Poppins:ital,wght@0,300;0,500;0,700;1,300;1,500;1,700&display=swap" rel=stylesheet><link href=https://brain.overment.com/styles.d59daaea419728f4212ffc8fc5871cc9.min.css rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=UA-99920491-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-99920491-1")</script><script>const BASE_URL="https://brain.overment.com/",fetchData=Promise.all([fetch("https://brain.overment.com/indices/linkIndex.95f33580ab6225a926d19158481c6ef3.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://brain.overment.com/indices/contentIndex.409990151a7b403e43b8c3dc26d76d45.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n}))</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Co chcesz wiedzieć?"><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://brain.overment.com/js/search.5905fee4a2affe871cf5006712c1bc0a.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://brain.overment.com/><img class=logo src=https://overment.com/images/logo-icon.svg alt=logo> brain.overment.com</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div></header><article><h1>Podstawy</h1><p class=meta>Ostatnia aktualizacja: 30/04/2022</p><ul class=tags></ul><aside class=mainTOC><details><summary>Zawartość tej strony</summary><nav id=TableOfContents><ol><li><a href=#instalacja>Instalacja</a></li><li><a href=#struktura-projektu>Struktura projektu</a></li><li><a href=#controllers>[[Controllers]]</a><ol><li><a href=#tworzenie-controllerów>Tworzenie controllerów</a></li></ol></li><li><a href=#services>[[Services]]</a><ol><li><a href=#tworzenie-serwisów>Tworzenie serwisów</a></li></ol></li><li><a href=#modules>[[Modules]]</a><ol><li><a href=#tworzenie-modułów>Tworzenie modułów</a></li></ol></li><li><a href=#data-transfer-objects>[[Data Transfer Objects]]</a><ol><li><a href=#tworzenie-dto>Tworzenie DTO</a></li></ol></li><li><a href=#validation>[[Validation]]</a></li></ol></nav></details></aside><h2 id=instalacja>Instalacja</h2><ol><li>Zainstalowanie CLI: <code>npm i -g @nestjs/cli</code></li><li>Utworzenie nowego projektu <code>nest new [nazwa]</code></li></ol><h2 id=struktura-projektu>Struktura projektu</h2><p>Podstawową struktury kodu w NestJS są klasy (eng. <a class="internal-link broken">classes</a>) oraz dekoratory (eng. <a class="internal-link broken">decorators</a>).</p><h2 id=controllers><a class="internal-link broken">Controllers</a></h2><p>Controllery to klasy, których zadaniem jest obsługa akcji poszczególnych ścieżek (<a class="internal-link broken">routing</a>) aplikacji. Przykładowo jeżeli użytkownik wejdzie na adres <code>https://brain.overment.com</code> to na pewnym etapie akcja controllera pobierze niezbędne dane i zwróci odpowiedź.</p><p>W NestJS controller można powiązać ze ścieżką, wykorzystując parametry przekazane do dekoratora Controllera oraz jego Akcji.</p><p>Powiązanie controllera ze ścieżką &lsquo;/users&rsquo;:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@Controller(&#39;users&#39;)
</span></span><span class=line><span class=cl>export class UsersController {}
</span></span></code></pre></td></tr></table></div></div><p>Powiązanie akcji controllera ze ścieżką /users/:id. Dodatkowo ta akcja przyjmuje również parametr <code>id</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class UsersController {
</span></span><span class=line><span class=cl>  **@Get(&#39;id&#39;)**
</span></span><span class=line><span class=cl>  find(@Param(&#39;id&#39;) id: number) {
</span></span><span class=line><span class=cl>  	return `User: ${id}`;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>Akcje kontrolera mogą przyjmować również <code>request body</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class UsersController {
</span></span><span class=line><span class=cl>  @Post()
</span></span><span class=line><span class=cl>  find(@Body() body) {
</span></span><span class=line><span class=cl>  	return `User: ${body.id}`;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>Akcje mogą przyjmować też parametry <code>query string</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class UsersController {
</span></span><span class=line><span class=cl>  @Get()
</span></span><span class=line><span class=cl>  find(@Query() query) {
</span></span><span class=line><span class=cl>  	return `User: ${query.id}`;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>Akcje mogą zwracać kod statusu</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class UsersController {
</span></span><span class=line><span class=cl>  @Post()
</span></span><span class=line><span class=cl>  @HttpCode(HttpStatus.OK)
</span></span><span class=line><span class=cl>  find(@Body() body) {}
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=tworzenie-controllerów>Tworzenie controllerów</h3><p>Z pomocą CLI: <code>nest g co</code> (lub <code>nest generate controller</code>) tworzymy plik controllera i spec.ts.</p><ul><li>flaga &ndash;no-spec umożliwia utworzenie controllera bez pliku spec.ts</li><li>podając w nazwie katalog, umieścisz go w podkatalogu</li><li>flaga &ndash;dry-run umożliwia przetestowanie polecenia</li></ul><h2 id=services><a class="internal-link broken">Services</a></h2><p>Serwisy umożliwiają rozdzielenie logiki naszej aplikacji na mniejsze części, ułatwiając jej organizację.</p><p>Przykład serwisu:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@Injectable()
</span></span><span class=line><span class=cl>export class UsersService {}
</span></span></code></pre></td></tr></table></div></div><p>Dodawanie serwisu np. do controllera odbywa się w konstruktorze:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@Controller()
</span></span><span class=line><span class=cl>export class UsersController {
</span></span><span class=line><span class=cl>  constructor(private readonly usersService: UsersService)
</span></span><span class=line><span class=cl>  // private declares and initializes field
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=tworzenie-serwisów>Tworzenie serwisów</h3><p>Z pomocą CLI <code>nest g s</code> (lub <code>nest generate service</code>) tworzymy plik serwisu i spec.ts</p><p>Serwis to zwykła klasa z dektoratorem @Injectable()</p><p>W Nest.js każdy serwis to <a class="internal-link broken">Provider</a>. Oznacza to, że serwisy mogą przyjmować zależności np. w postaci innych serwisów.</p><h2 id=modules><a class="internal-link broken">Modules</a></h2><p>W NestJS moduły pozwalają na organizowanie logiki biznesowej powiązanych ze sobą fragmentów (np. AuthModule)</p><p>Dekorator @Module przyjmuje obiekt zawierający informację o:</p><ul><li>controllerach (z których korzysta dany moduł)</li><li>exportowanych providerach, które mają być dostępne tam, gdzie importowany jest moduł</li><li>importowanych modułach</li><li>wykorzystywanych providerach, które będą dostępne tylko w tym module</li></ul><h3 id=tworzenie-modułów>Tworzenie modułów</h3><p>Z pomocą CLI <code>nest g module</code> tworzymy nowy moduł aplikacji oraz aktualizujemy główny moduł aplikacji (src/app.module.ts)</p><h2 id=data-transfer-objects><a class="internal-link broken">Data Transfer Objects</a></h2><p>DTO pozwalają na określenie interfejsów dla danych wejściowych i wyjściowych w aplikacji. Np. z ich pomocą możemy określić kształt wymaganego obiektu.</p><p>DTO to proste obiekty, których rolą jest po prostu określenie struktury danych. Nie zawierają żadnej logiki biznesowej ani czegokolwiek, co wymaga testowania.</p><p>Przykład:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class CreateUserDto {
</span></span><span class=line><span class=cl>  name: string;
</span></span><span class=line><span class=cl>  brand: string;
</span></span><span class=line><span class=cl>  flavors: string[];
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=tworzenie-dto>Tworzenie DTO</h3><p>Z pomocą CLI <code>nest g class users/dto/create-user.dto --no-spec</code>generujemy plik <code>create-user.dto.ts</code> eksportujący klasę <code>CreateUserDto</code></p><h2 id=validation><a class="internal-link broken">Validation</a></h2><ul><li>W pliku main.ts dodaj globalPipe: app.useGlobalPipes(new ValidationPipe())</li><li>Zainstaluj class-validator class-transformer</li></ul><p>import { IsString } from &lsquo;class-validator&rsquo;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>export class CreateUserDto {
</span></span><span class=line><span class=cl>  @IsString()
</span></span><span class=line><span class=cl>  readonly name: string;
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  @IsString({ roles })
</span></span><span class=line><span class=cl>  readonly roles: string[];
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div></article><hr><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Mapa treści</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://brain.overment.com/js/graph.431609979d6b88f5a5093224a89a1226.js></script>
<script>drawGraph("https://brain.overment.com/Wiedza/Programowanie/NestJS/Podstawy","https://brain.overment.com",[{"/moc":"#4388cc"}],-1,!0,!1,!0)</script><div class=page-end><div class=backlinks-container><h3>Powiązania</h3><ul class=backlinks><li>Brak powiązań</li></ul></div><div></div></div><script defer>(()=>{const e=document.querySelectorAll(".singlePage article a");e.forEach(e=>{const s=e.textContent,n=s.split("/"),t=n[n.length-1];t.indexOf("]]")>-1?e.textContent=t.slice(0,-2):e.textContent=t})})()</script><script src=https://brain.overment.com/js/popover.e57188d2e4c06b0654e020b3a734bb62.min.js></script>
<script>initPopover("https://brain.overment.com")</script></div></body></html>